<%

json.questions.forEach(function(q) {
  switch (q.type) {
    case "multiple-choice":
      q.options = [];
      json.answers = json.answers.filter(function(a) {
        if (a.question == q.id) {
          q.options.push(a);
          return false;
        }
        return true;
      });
      break;
  
    case "graph":
      q.data = json[q.image];
      break;
  }
});

%><!doctype html>
<html lang="en-US">
  <head>
    <%= t.include("partials/_head.html", grunt.data.json) %>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>

    <%= t.include("partials/_nav.html") %>

    <%= t.include("partials/_ad.html", { type: "banner" }) %>

    <header class="intro">

      <h3 class="tagline">The FYI Guy</h3>
      <h1>Who are Seattle's newcomers?</h1>

      <p class="chatter">
        If you’re reading this in Seattle, there’s a good chance you lived somewhere else one year ago today. More than 60,000 city residents – nearly one in ten of us – moved here from outside King County within the past year.

      <p class="chatter">
        We’re the fastest-growing big city in the country right now, and all those newly-arrived people are reshaping Seattle.  But how much do you know about newcomers? Take our quiz and find out!

    </header>

    <main class="quiz-body">
      <% json.questions.forEach(function(q, i) { %>
        <h2>Q<%= i + 1 %>: <%= q.title %></h2>
        <%= t.include(`_${q.type}.html`, q) %>
      <% }) %>

      <div class="score-block"></div>
    </main>

    <div class="comment-container">
      <%= t.include("partials/_comments.html", { article: "designer-app-1508195456578" }) %>
    </div>

    <%= t.include("partials/_navBottom.html") %>

    <script src="app.js" async></script>
    <% if (json.project.production) { %>
    <%= !json.project.embedded ? t.include("partials/_analytics.html") : "" %>
    <%= t.include("partials/_workHere.html") %>
    <% } %>
  </body>
</html>
